var c1,wijmo,__extends=this&&this.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t=(s._random=function(e,t){return e+Math.random()*(t-e)},s._isObject=function(e){return null!=e&&"object"==typeof e&&!(e instanceof Date)},s.copy=function(e,t){var n,r;for(n in t)r=t[n],e._copy&&e._copy(n,r)||(s._isObject(r)&&e[n]?s.copy(e[n],r):e[n]=r);return e},s.extend=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=t.map(function(e){return s.copy({},e)});return r.unshift(e),r.reduceRight(function(e,t){return s.copy(t,e)})},s._formEncodedObject=function(e){var t,n,r=[];for(t in e)n=e[t],n=s._isObject(n)?JSON.stringify(n):n&&encodeURIComponent(n.toString()),r.push(t+"="+n);return r.join("&")},s.ajax=function(e){var t,n,r,o,i=new XMLHttpRequest,a=s.copy({async:!0,cache:!1,type:"GET",postType:"form"},e),l=a.url;if("string"==typeof a.data||a.data instanceof Blob||a.data instanceof Document||a.data instanceof FormData)t=a.data;else if(s._isObject(a.data))if("GET"===a.type)l+=0<=l.indexOf("?")?"&":"?",l+=s._formEncodedObject(a.data);else if("form"===a.postType)t=s._formEncodedObject(a.data),a.contentType="application/x-www-form-urlencoded";else if("json"===a.postType)t=JSON.stringify(a.data),a.contentType="application/json";else if("multipart"===a.postType){for(n in t=new FormData,a.data)t.append(n,a.data[n]);a.contentType="multipart/form-data"}if(i.onload=function(e){var t;500<=i.status?a.error&&a.error.bind(i)():("json"===a.dataType?t=JSON.parse(i.responseText):"text"===a.dataType||"html"===a.dataType||"script"===a.dataType?t=i.responseText:"xml"===a.dataType&&(t=i.responseXML),a.success.bind(i)(t))},a.error&&(i.onerror=a.error.bind(i)),a.cache||(o="_="+s._random(1e3,9999).toFixed(0),l+=0<=l.indexOf("?")?"&":"?",l+=o),i.open(a.type,l,a.async),a.headers)for(r in a.headers)i.setRequestHeader(r,a.headers[r]);a.contentType&&i.setRequestHeader("Content-Type",a.contentType),a.beforeSend&&a.beforeSend(i,a),i.send(t)},s.beginRequest=function(e,t,n,r,o,i){void 0===r&&(r=null),void 0===o&&(o="json"),void 0===i&&(i=null),s.ajax({async:!0,data:r,dataType:o,type:t,success:n,url:e,error:i})},s.get=function(e,t,n,r){void 0===n&&(n=null),void 0===r&&(r="json"),s.beginRequest(e,"GET",t,n,r)},s.post=function(e,t,n,r,o){void 0===n&&(n=null),void 0===r&&(r=null),void 0===o&&(o="json"),s.beginRequest(e,"POST",t,n,o,r)},s.load=function(t,e,n){void 0===n&&(n=null),s.beginRequest(e,"GET",function(e){document.querySelector(t).innerHTML=e},n,"html")},s);function s(){}e.AjaxHelper=t}(wijmo=wijmo||{}),function(l){"use strict";function s(e){return"disabled"===e||"required"===e||"showDropDown"===e}var o;function c(e){e.onload=null,e.innerHTML=""}l._isPropertyDeprecated=s,l.getSerializableObject=function(e,t,n){t=l.asArray(t)||function(e){for(var t,n,r,o,i,a=[];null!==e;e=Object.getPrototypeOf(e))for(o=(t=Object.getOwnPropertyNames(e)).length,r=0;r<o;r++)"_"===(n=t[r].trim())[0]||s(n)||(i=Object.getOwnPropertyDescriptor(e,n))&&i.set&&i.get&&a.push(n);return a}(e),n=l.asArray(n);var r,o,i={},a=t.length;for(r=0;r<a;r++)"_"!==(o=t[r])[0]&&o in e&&(n&&!l.isUndefined(n)&&n.some(function(e){return o===e})||(i[o]=e[o]));return i},l.postFormRequest=function(t,n,r){void 0===r&&(r=null),o&&(c(o),o.parentNode.removeChild(o),o=null),(o=document.createElement("iframe")).style.display="none",o.src="about:blank",o.onload=function(e){!function(e,t,n,r){void 0===r&&(r=null);var o=u(l.serialize(n)),i='<input type="hidden" name="data" value="'+o+'" />';o=u(l.serialize(r)),null!==r&&(i+='<input type="hidden" name="setting" value="'+o+'" />');var a=function(e){var t=e.contentWindow||e.contentDocument;t.document&&(t=t.document);return t}(e);a.write("<html><head><meta http-equiv='Content-Type' content='text/html; charset=utf-8'></head><body><form method='POST' accept-charset='utf-8' action='"+t+"'>"+i+"</form></body></html>"),a.querySelector("form").submit(),setTimeout(function(){c(e)},0)}(o,t,n,r)},document.body.appendChild(o)};var t=/[<>&\r\n"']/gm,n={"<":"lt;",">":"gt;","&":"amp;","\r":"#13;","\n":"#10;",'"':"quot;","'":"apos;"};function u(e){return e.replace(t,function(e){return"&"+n[e]})}function r(e,t){return"_"===e[0]?void 0:t}l.serialize=function(e,t){return t&&function e(t,n){if(n)for(var r in t)l.isObject(t[r])&&n[r]?e(t[r],n[r]):t[r]===n[r]&&delete t[r]}(e,t),JSON.stringify(e,r)}}(wijmo=wijmo||{}),function(e){"use strict";var t;(t=e.ExportFileType||(e.ExportFileType={}))[t.Xls=0]="Xls",t[t.Xlsx=1]="Xlsx",t[t.Csv=2]="Csv",t[t.Pdf=3]="Pdf",t[t.Png=4]="Png",t[t.Jpg=5]="Jpg",t[t.Bmp=6]="Bmp",t[t.Gif=7]="Gif",t[t.Tiff=8]="Tiff"}(wijmo=wijmo||{}),function(P){var z,G,e;function F(){}z=P.grid||(P.grid={}),G=z.excel||(z.excel={}),F.Load=function(e,t,n){var o=this;n=n||{},e.itemsSource=null,e.columns.clear(),e.columnHeaders.rows.clear(),e.rows.clear(),e.frozenColumns=0,e.frozenRows=0,e.itemFormatter=null;var i,r=(e.mergeManager=null)==n.sheetIndex||isNaN(n.sheetIndex)?0:n.sheetIndex;if(r<0||r>=t.sheetCount)throw"The sheet index option is out of the sheet range of current workbook.";if(null!=n.sheetName&&t.sheets[n.sheetName]&&(i=t.sheets[n.sheetName]),0!=(i=i||t.sheets[Object.keys(t.sheets)[r]]).rowCount&&0!=i.columnCount){if(i&&i.namedStyles)for(var a=0,l=i.namedStyles;a<l.length;a++){var s=l[a];s&&s.formatter&&(s.formatter=P.xlsx.Workbook.fromXlsxFormat(s.formatter)[0])}null!=i.defaults?(e.rows.defaultSize=G.ExcelStyleConverter.PointToPixel(i.defaults.rowHeight,!0),e.columns.defaultSize=G.ExcelStyleConverter.PointToPixel(i.defaults.colWidth,!0)):(e.rows.defaultSize=G.ExcelStyleConverter.PointToPixel(28,!0),e.columns.defaultSize=G.ExcelStyleConverter.PointToPixel(112,!0));var c=(null==n.includeColumnHeaders||n.includeColumnHeaders)&&0<i.rows.length,u=c?1:0,f=i.columns,d=i.rows,p=i.rowCount,m=i.columnCount;P.isNumber(i.frozenColCount)&&!isNaN(i.frozenColCount)&&(e.frozenColumns=i.frozenColCount),P.isNumber(i.frozenRowCount)&&!isNaN(i.frozenRowCount)&&(e.frozenRows=c&&0<i.frozenRowCount?i.frozenRowCount-1:i.frozenRowCount);for(var y=0;y<m;y++){e.columns.push(new z.Column);var g=-1;f[y]&&(isNaN(+f[y].size)||(g=G.ExcelStyleConverter.PointToPixel(+f[y].size,!0)),f[y].visible||null==f[y].visible||(e.columns[y].visible=!!f[y].visible)),-1==g&&(g=e.columns.defaultSize),-1!=g&&(e.columns[y].size=G.ExcelStyleConverter.PointToPixel(g,!0))}for(var h=i.data?i.data.dataTable:null,b=0;b<u;b++)for(e.columnHeaders.rows.push(new z.Row),y=0;y<i.columnCount;y++)(D=F._GetCellData(h,b,y))&&e.columnHeaders.setCellData(b,y,F._ParseCellValue(D));c||e.columnHeaders.rows.push(new z.Row);var x=[];for(b=u;b<p;b++){var w=null;if(i.rowOutlines&&i.rowOutlines.itemsData)for(var v=0,C=i.rowOutlines.itemsData;v<C.length;v++){var S=C[v];if(S&&S.index==b+1){w=S.info;break}}if(w){var T=new z.GroupRow;T.level=1+(isNaN(w.level)?0:w.level),e.rows.push(T)}else{var _=new z.Row;e.rows.push(_)}var j=-1;for(d[b]&&(isNaN(+d[b].size)||(j=G.ExcelStyleConverter.PointToPixel(+d[b].size,!0),null!=d[b].visible&&(e.rows[b-u].visible=d[b].visible))),-1==j&&(j=e.rows.defaultSize),-1!=j&&(e.rows[b-u].size=G.ExcelStyleConverter.PointToPixel(j,!0)),y=0;y<i.columnCount;y++){var D=F._GetCellData(h,b,y),O=F._GetCellStyle(i,D);if(O&&O.formatter&&e.columns[y]&&!e.columns[y].format&&(e.columns[y].format=O.formatter),D&&e.setCellData(b-u,y,F._ParseCellValue(D)),x[y]){var E=this._getItemType(D);x[y]!==E&&x[y]===P.DataType.Boolean&&(x[y]=E)}else x[y]=this._getItemType(D)}}for(y=0;y<i.columnCount;y++)e.columns[y].dataType=x[y];e.itemFormatter=function(e,t,n,r){o.FormatCell(i,h,u,e,t,n,r)},i&&0<i.spans.length&&(e.allowMerging=P.grid.AllowMerging.Cells,e.mergeManager=new G.FlexGridMergeManager(e,i.spans,u))}},F._getItemType=function(e){return null==e||null==e.value||isNaN(e.value)?null:P.getType(e.value)},F.FormatCell=function(e,t,n,r,o,i,a){if(!r||1==r.cellType){var l=F._GetCellData(t,o+n,i),s=r.getCellData(o,i,!1),c=F._GetCellStyle(e,l);c=c||F._GetDefaultCellStyle(e),G.ExcelStyleConverter.ExcelStyleToCssStyle(c,s,a.style);var u=G.ExcelStyleConverter.ExcelValueToHTML(c,s);u&&r.columns[i].dataType!==P.DataType.Boolean&&(a.innerHTML=u)}},F._GetDefaultCellStyle=function(e){return e&&e.data&&e.data.defaultDataNode&&e.data.defaultDataNode.style?e.data.defaultDataNode.style:null},F._GetCellStyle=function(e,t){if(e&&t){if(t.style)for(var n=0,r=e.namedStyles;n<r.length;n++){var o=r[n];if(o.name==t.style)return o}return null}},F._GetCellData=function(e,t,n){var r=t.toString(),o=n.toString();return e&&e.hasOwnProperty(r)&&e[r]&&e[r].hasOwnProperty(o)?e[r][o]:null},F._ParseCellValue=function(e){if(e.formula&&e.value&&P.isObject(e.value)){if(e.value.hasOwnProperty("_error"))return e.value._error}else if(e.value&&P.isObject(e.value)&&e.value.hasOwnProperty("richText")){var t=e.value.richText;if(t){for(var n="",r=0,o=t;r<o.length;r++){var i=o[r],a="";i.style&&(i.style.font&&(a+=" font : "+i.style.font+";"),i.style.foreColor&&(a+=" color : "+i.style.foreColor+";")),n+='<span style="'+a+'">'+i.text+"</span>"}return n}}else if(e.value&&P.isString(e.value)&&-1!=e.value.indexOf("OADate")){var l=G.ExcelStyleConverter.OADateStringToJSDate(e.value);l&&(e.value=l)}return e.value},e=F,G.ExcelToFlexGridLoader=e}(wijmo=wijmo||{}),function(e){var t;(function(e){"use strict";var t,n,r,o;(t=e.GcTextDercorationType||(e.GcTextDercorationType={}))[t.None=0]="None",t[t.Underline=1]="Underline",t[t.LineThrough=2]="LineThrough",t[t.Overline=3]="Overline",t[t.UnderlineDouble=8]="UnderlineDouble",(n=e.GcBorderStyle||(e.GcBorderStyle={}))[n.None=0]="None",n[n.Hair=1]="Hair",n[n.DashDotDot=2]="DashDotDot",n[n.DashDot=3]="DashDot",n[n.Dotted=4]="Dotted",n[n.Dashed=5]="Dashed",n[n.Thin=6]="Thin",n[n.MediumDashDotDot=7]="MediumDashDotDot",n[n.SlantDashDot=8]="SlantDashDot",n[n.MediumDashDot=9]="MediumDashDot",n[n.MediumDashed=10]="MediumDashed",n[n.Medium=11]="Medium",n[n.Thick=12]="Thick",n[n.Double=13]="Double",(r=e.GcHorizontalAlignment||(e.GcHorizontalAlignment={}))[r.Left=0]="Left",r[r.Center=1]="Center",r[r.Right=2]="Right",r[r.General=3]="General",(o=e.GcVerticalAlignment||(e.GcVerticalAlignment={}))[o.Top=0]="Top",o[o.Center=1]="Center",o[o.Bottom=2]="Bottom",o[o.Justify=3]="Justify",o[o.Distributed=4]="Distributed"})((t=e.grid||(e.grid={})).excel||(t.excel={}))}(wijmo=wijmo||{}),function(a){!function(e){"use strict";var t=(n.prototype.requestImport=function(t,e,n,r){void 0===r&&(r=!1);var o=this,i=new FormData;i.append("file",n),a.AjaxHelper.post(e,function(e){o._ImportXlsxToFlexGrid(t,e,!("sheets"in t)&&r)},i,function(){var e=new Error(this.responseText||"Unknown error occurs.");throw e.name=this.statusText||e.name,e})},n.prototype._ImportXlsxToFlexGrid=function(e,t,n,r){void 0===n&&(n=!1),void 0===r&&(r=!0),a.grid.excel.ExcelToFlexGridLoader.Load(e,t,{includeStyles:r,includeColumnHeaders:n})},n);function n(){}e.ExcelImporter=t}(a.grid||(a.grid={}))}(wijmo=wijmo||{}),function(r){var e,o,t;function n(){}e=r.grid||(r.grid={}),o=e.excel||(e.excel={}),n.PointToPixel=function(e,t){return void 0===t&&(t=!1),e},n.OADateStringToJSDate=function(e){return e&&-1!=e.indexOf("OADate")?new Date(86400*(parseInt(e.replace("/OADate(","").replace(")/",""))-25569)*1e3):null},n.ExcelFormatToWijmoFormat=function(e,t){if(null!=e&&!isNaN(e))return r.isDate(e)?r.xlsx.Workbook.fromXlsxFormat(t)[0]:!r.isNumber(e)||t&&"General"!==t?r.isNumber(e)||""===e?r.xlsx.Workbook.fromXlsxFormat(t)[0]:t:r.isInt(e)?"d":"f2"},n.ExcelLineStyleToCssBorderStyle=function(e){var t="";switch(e){case 0:t="none";break;case 1:case 2:case 5:t="thin";break;case 3:t="dashed";break;case 4:t="dotted";break;case 6:t="double";break;default:t="thin"}return t},n._GetValueDataType=function(e){return null==e||isNaN(e)?null:r.getType(e)},n.ExcelValueToHTML=function(e,t){return t&&e&&e.formatter?r.Globalize.format(t,e.formatter):t},n.ExcelStyleToCssStyle=function(e,t,n){if(!e)return null;switch((n=n||document.createElement("div").style).font="",e.font&&(n.font=e.font),n.color="",e.foreColor&&(n.color=e.foreColor),n.background="",e.backColor&&(n.background=e.backColor),n.display="flex",e.hAlign){case o.GcHorizontalAlignment.Left:n.justifyContent="flex-start";break;case o.GcHorizontalAlignment.Center:n.justifyContent="center";break;case o.GcHorizontalAlignment.Right:n.justifyContent="flex-end";break;case o.GcHorizontalAlignment.General:if(null!=t&&!isNaN(t))switch(this._GetValueDataType(t)){case r.DataType.Date:case r.DataType.Number:n.justifyContent="flex-end";break;case r.DataType.Boolean:n.justifyContent="center";break;default:e.formatter&&0===e.formatter.search(/[n,c,p]/i)?n.justifyContent="flex-end":n.justifyContent="flex-start"}break;default:n.justifyContent=""}switch(e.vAlign){case o.GcVerticalAlignment.Top:n.alignItems="flex-start";break;case o.GcVerticalAlignment.Center:n.alignItems="center";break;case o.GcVerticalAlignment.Bottom:n.alignItems="flex-end";break;default:n.alignItems="center"}return n.whiteSpace="",e.wordWrap&&(n.whiteSpace="normal"),n},t=n,o.ExcelStyleConverter=t}(wijmo=wijmo||{}),function(i){"use strict";var a=(Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(e){this._type=i.asEnum(e,i.ExportFileType,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fileName",{get:function(){return this._fileName},set:function(e){this._fileName=i.asString(e,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"workbook",{get:function(){return this._workbook},set:function(e){this._workbook=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"includeColumnHeaders",{get:function(){return this._includeColumnHeaders},set:function(e){this._includeColumnHeaders=i.asBoolean(e,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onlyCurrentPage",{get:function(){return this._onlyCurrentPage},set:function(e){this._onlyCurrentPage=i.asBoolean(e,!1)},enumerable:!0,configurable:!0}),e);function e(){}i.ExcelExportSettings=a;var t=(n.prototype.requestExport=function(e,t,n){var r,o=new a;t=i.asString(t,!1),o.workbook=e,this._processWorkbook(o.workbook),i.copy(o,n),r=i.getSerializableObject(o),i.postFormRequest(t,r)},n.prototype._processWorkbook=function(e){e.sheets&&e.sheets.forEach(function(e){e.columns&&e.columns.forEach(function(e){e.width&&(e.width=e.width.toFixed(0))}),e.rows&&e.rows.forEach(function(e){e.cells&&e.cells.forEach(function(e){e&&(1===e.colSpan&&delete e.colSpan,1===e.rowSpan&&delete e.rowSpan,i.isDate(e.value)&&(e.value=i.Globalize.formatDate(e.value,"yyyy-MM-dd HH:mm:ss").replace(" ","T"),e.isDate=!0))})})})},n);function n(){}i.ExcelExporter=t}(wijmo=wijmo||{}),function(n){!function(a){"use strict";var l,e=(l=n.ExcelExporter,__extends(t,l),t.prototype.requestExport=function(e,t,n){var r,o=e.collectionView,i=o&&o.pageSize;e instanceof a.FlexGrid&&(i&&!n.onlyCurrentPage&&(e.collectionView.pageSize=0),r="sheets"in e?e.saveToWorkbookOM():a.xlsx.FlexGridXlsxConverter.save(e,{includeColumnHeaders:!(!n.includeColumnHeaders&&!n.includeColumnHeader),includeStyles:!0})._serialize(),i&&!n.onlyCurrentPage&&(e.collectionView.pageSize=i),l.prototype.requestExport.call(this,r,t,n))},t);function t(){return null!==l&&l.apply(this,arguments)||this}a.ExcelExporter=e}(n.grid||(n.grid={}))}(wijmo=wijmo||{}),function(e){var t;(t=e.grid||(e.grid={})).excel||(t.excel={})}(wijmo=wijmo||{}),function(e){var t;(function(e){"use strict";var u,t=(u=wijmo.grid.ExcelExporter,__extends(n,u),n.prototype.requestExport=function(t,n,r,o){var i,a,l,s=this,e=t.collectionView,c=u.prototype.requestExport;e&&e.getAllData&&!1===e._disableServerRead&&(!r.onlyCurrentPage&&e.pageSize||e._isDynamicalLoadingEnabled&&e._isDynamicalLoadingEnabled())?e.getAllData(function(e){(l=document.createElement("div")).style.display="none",(i=t.hostElement.parentElement).appendChild(l),(a=new wijmo.grid.FlexGrid(l)).autoGenerateColumns=!1,a.itemsSource=e.items,s._setFlexGrid(t,a),o&&o(a),delete r.onlyCurrentPage,c.call(s,a,n,r),i.removeChild(l)}):c.call(s,t,n,r)},n.prototype._setFlexGrid=function(e,t){var n,r,o=e.columns,i=e.collectionView.groupDescriptions;for(n=0;n<o.length;n++)r=new wijmo.grid.Column,this.copyColumn(r,o[n]),t.columns.push(r);for(n=0;n<i.length;n++)t.collectionView.groupDescriptions.push(i[n])},n.prototype.copyColumn=function(e,t){var n,r;for(n in t)if(!wijmo._isPropertyDeprecated(n))if("width"!=n||null==wijmo.grid.Column._parseStarSize(t.width)){r=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(t),n);for(var o=t.__proto__;!r&&o&&!o.isPrototypeOf(Object);)(r=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(o),n))||(o=o.__proto__);r&&r.set&&r.get&&(e[n]=t[n])}else e.width=t.size},n);function n(){return null!==u&&u.apply(this,arguments)||this}e.ExcelExporter=t})((t=e.mvc||(e.mvc={})).grid||(t.grid={}))}(c1=c1||{}),function(l){var e,t,o,n;function r(e,t,n){var r=o.call(this)||this;return r.mergedRanges=[],r.rowHeaderCount=0,r.mergedRanges=t,r.rowHeaderCount=n,r}e=l.grid||(l.grid={}),t=e.excel||(e.excel={}),o=l.grid.MergeManager,__extends(r,o),r.prototype.getMergedRange=function(e,t,n,r){if(void 0===r&&(r=!0),!e||1==e.cellType){t+=this.rowHeaderCount;for(var o=0,i=this.mergedRanges;o<i.length;o++){var a=i[o];if(t>=a.row&&t<a.row+a.rowCount&&n>=a.col&&n<a.col+a.colCount)return new l.grid.CellRange(a.row-this.rowHeaderCount,a.col,a.row+a.rowCount-1-this.rowHeaderCount,a.col+a.colCount-1)}return null}},n=r,t.FlexGridMergeManager=n}(wijmo=wijmo||{}),function(a){"use strict";var t,e;(e=t=a.ImageControlType||(a.ImageControlType={}))[e.FlexChart=0]="FlexChart",e[e.FlexPie=1]="FlexPie",e[e.LinearGauge=2]="LinearGauge",e[e.RadialGauge=3]="RadialGauge",e[e.BulletGraph=4]="BulletGraph",e[e.Sunburst=5]="Sunburst",e[e.FlexRadar=6]="FlexRadar",e[e.TreeMap=7]="TreeMap";var l=(Object.defineProperty(n.prototype,"type",{get:function(){return this._type},set:function(e){this._type=a.asEnum(e,a.ExportFileType,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"controlType",{get:function(){return this._controlType},set:function(e){this._controlType=a.asEnum(e,t,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fileName",{get:function(){return this._fileName},set:function(e){this._fileName=a.asString(e,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},set:function(e){this._height=a.asNumber(e,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this._width},set:function(e){this._width=a.asNumber(e,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"state",{get:function(){return this._state},set:function(e){this._state=a.asString(e,!1)},enumerable:!0,configurable:!0}),n);function n(){}a.ImageExportSettings=l;var r=(o.prototype.requestExport=function(e,t,n){var r,o,i=new l;t=a.asString(t,!1),i.state=a.serialize(this._getSerializableControl(e)),i.controlType=this._getImageControlType(e),o=e.hostElement.getBoundingClientRect(),i.height=a.asNumber(i.height,!0)||o.height,i.width=a.asNumber(i.width,!0)||o.width,a.copy(i,n),r=a.getSerializableObject(i),a.postFormRequest(t,r)},o.prototype._getSerializableControl=function(e){return a.getSerializableObject(e,null,["itemFormatter"])},o.prototype._getImageControlType=function(e){if(e instanceof a.chart.radar.FlexRadar)return t.FlexRadar;if(e instanceof a.chart.hierarchical.Sunburst)return t.Sunburst;if(e instanceof a.chart.FlexChart)return t.FlexChart;if(e instanceof a.chart.FlexPie)return t.FlexPie;if(e instanceof a.gauge.BulletGraph)return t.BulletGraph;if(e instanceof a.gauge.LinearGauge)return t.LinearGauge;if(e instanceof a.gauge.RadialGauge)return t.RadialGauge;if(e instanceof a.chart.hierarchical.TreeMap)return t.TreeMap;throw"This type control isn't supported."},o);function o(){}a.ImageExporter=r}(wijmo=wijmo||{}),function(s){!function(i){"use strict";var a,e=(a=s.ImageExporter,__extends(l,a),l.prototype._getSerializableControl=function(e){var t,n=a.prototype._getSerializableControl.call(this,e),r=0;if(n.itemsSource=l._collectionViewToArray(e),n.legend=s.getSerializableObject(e.legend),n.dataLabel=s.getSerializableObject(e.dataLabel),e instanceof i.FlexChartCore){for(n.axisX=s.getSerializableObject(e.axisX),n.axisX.itemsSource=l._collectionViewToArray(e.axisX),n.axisY=s.getSerializableObject(e.axisY),n.axisY.itemsSource=l._collectionViewToArray(e.axisY),n.series=[],r=0;r<e.series.length;r++){t=e.series[r];var o=s.getSerializableObject(t,void 0,["axisX","axisY"]);t.axisX&&(o.axisX=s.getSerializableObject(t.axisX)),t.axisY&&(o.axisY=s.getSerializableObject(t.axisY)),o.innerType=l._getSeriesType(t),t instanceof s.chart.analytics.YFunctionSeries?t.func&&(o.func=t.func.toString()):t instanceof s.chart.analytics.ParametricFunctionSeries&&(t.xFunc&&(o.xFunc=t.xFunc.toString()),t.yFunc&&(o.yFunc=t.yFunc.toString())),n.series.push(o),n.series[r].itemsSource=l._collectionViewToArray(t)}e.selection&&(n.selection=s.getSerializableObject(e.selection))}return n},l._getSeriesType=function(e){return e instanceof s.chart.analytics.Waterfall?"wijmo.chart.analytics.Waterfall":e instanceof s.chart.analytics.ErrorBar?"wijmo.chart.analytics.ErrorBar":e instanceof s.chart.analytics.BoxWhisker?"wijmo.chart.analytics.BoxWhisker":e instanceof s.chart.analytics.YFunctionSeries?"wijmo.chart.analytics.YFunctionSeries":e instanceof s.chart.analytics.ParametricFunctionSeries?"wijmo.chart.analytics.ParametricFunctionSeries":e instanceof s.chart.analytics.MovingAverage?"wijmo.chart.analytics.MovingAverage":e instanceof s.chart.analytics.TrendLine?"wijmo.chart.analytics.TrendLine":e instanceof s.chart.radar.FlexRadarSeries?"wijmo.chart.radar.FlexRadarSeries":void 0},l._collectionViewToArray=function(e){var t,n;if(null!=e&&null!=e.itemsSource)return void 0===e.collectionView?(t=e.itemsSource,null!=(n=s.tryCast(t,"ICollectionView"))&&(t=n.sourceCollection)):t=null==e.collectionView?null:e.collectionView.sourceCollection,t instanceof s.collections.ObservableArray&&(t=t.slice(0)),t},l);function l(){return null!==a&&a.apply(this,arguments)||this}i.ImageExporter=e}(s.chart||(s.chart={}))}(wijmo=wijmo||{}),function(a){!function(o){"use strict";var i,e=(i=a.ImageExporter,__extends(t,i),t.prototype._getSerializableControl=function(e){var t,n=i.prototype._getSerializableControl.call(this,e),r=0;if(!(e instanceof o.BulletGraph))for(n.ranges=[],r=0;r<e.ranges.length;r++)(t=a.getSerializableObject(e.ranges[r])).name=null,n.ranges.push(t);return n.face=a.getSerializableObject(e.face),n.pointer=a.getSerializableObject(e.pointer),n},t);function t(){return null!==i&&i.apply(this,arguments)||this}o.ImageExporter=e}(a.gauge||(a.gauge={}))}(wijmo=wijmo||{});